<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PTS Report Card</title>
  <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
    }

    body {
      background-color: #f5f5f5;
      padding: 20px;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      background-color: white;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      border-radius: 8px;
      padding: 20px;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 1px solid #eee;
    }

    .logo {
      display: flex;
      align-items: center;
    }

    .logo img {
      width: 50px;
      height: 50px;
      margin-right: 10px;
    }

    .logo h1 {
      font-size: 28px;
      font-weight: bold;
    }

    .icon {
      width: 30px;
      height: 30px;
    }

    .breadcrumbs {
      display: flex;
      gap: 10px;
      margin-bottom: 15px;
      flex-wrap: wrap;
    }

    .breadcrumb-item {
      background-color: #f0f0f0;
      padding: 5px 10px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
    }

    .breadcrumb-item.active {
      background-color: #1976d2;
      color: white;
    }

    .settings {
      display: flex;
      justify-content: space-between;
      margin-bottom: 20px;
      flex-wrap: wrap;
      gap: 10px;
    }

    .settings-group {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    select, input {
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }

    .subjects-scroll {
      position: relative;
      overflow-x: auto;
      white-space: nowrap;
      margin-bottom: 20px;
      padding: 10px 0;
      -ms-overflow-style: none;
      scrollbar-width: none;
    }

    .subjects-scroll::-webkit-scrollbar {
      display: none;
    }

    .subjects {
      display: inline-flex;
      gap: 10px;
    }

    .subject {
      min-width: 150px;
      padding: 10px 20px;
      background-color: #f0f0f0;
      border-radius: 5px;
      text-align: center;
      cursor: pointer;
      font-weight: bold;
    }

    .subject.active {
      background-color: #1976d2;
      color: white;
    }

    .student-info {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 8px;
    }

    .info-group {
      display: flex;
      align-items: center;
    }

    .info-group label {
      min-width: 100px;
      margin-right: 10px;
    }

    .info-group input {
      flex: 1;
    }

    .subject-header {
      background-color: #1a1a1a;
      color: white;
      padding: 8px 15px;
      text-align: center;
      border-radius: 5px;
      margin-bottom: 15px;
      font-weight: bold;
    }

    .stats-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 15px;
    }

    .stats-table th, .stats-table td {
      border: 1px solid #ddd;
      padding: 10px;
      text-align: center;
    }

    .stats-table th {
      background-color: #f5f5f5;
    }

    .topics-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 15px;
    }

    .topic-section {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 15px;
    }

    .topic-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
      border-bottom: 1px solid #eee;
      padding-bottom: 8px;
    }

    .topic-list {
      display: grid;
      gap: 8px;
    }

    .topic-row {
      display: grid;
      grid-template-columns: 1fr 40px;
      align-items: center;
    }

    .learning-section {
      padding: 10px;
      border-top: 1px solid #eee;
      margin-top: 10px;
    }

    .learning-section h4 {
      margin-bottom: 8px;
    }

    .text-area {
      width: 100%;
      min-height: 100px;
      border: 1px solid #ddd;
      padding: 10px;
      margin-top: 10px;
      resize: none;
    }

    .actions {
      display: flex;
      justify-content: center;
      margin-top: 20px;
    }

    button {
      padding: 10px 20px;
      background-color: #1976d2;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
    }

    button:hover {
      background-color: #1565c0;
    }
  </style>
</head>
<body>
  <div class="container" id="report-card">
    <div class="header">
      <div class="logo">
        <img src="https://via.placeholder.com/50" alt="PARMAR SSG">
        <h1>PTS REPORT CARD</h1>
      </div>
      <img src="https://via.placeholder.com/30" alt="Menu" class="icon">
    </div>

    <div class="breadcrumbs" id="breadcrumbs">
      <!-- Breadcrumbs will be dynamically added here -->
    </div>

    <div class="settings">
      <div class="settings-group">
        <label for="marks-per-question">Marks per question:</label>
        <select id="marks-per-question">
          <option value="2">2</option>
          <option value="3">3</option>
        </select>
      </div>
      <div class="settings-group">
        <label for="negative-marking">Negative marking:</label>
        <select id="negative-marking">
          <option value="none">None</option>
          <option value="0.25">1/4</option>
          <option value="0.33">1/3</option>
          <option value="0.5">1/2</option>
        </select>
      </div>
    </div>

    <div class="subjects-scroll">
      <div class="subjects" id="subjects">
        <div class="subject active" data-subject="maths">MATHS</div>
        <div class="subject" data-subject="english">ENGLISH</div>
        <div class="subject" data-subject="gkgs">GK/GS</div>
        <div class="subject" data-subject="reasoning">REASONING</div>
      </div>
    </div>

    <div class="student-info">
      <div class="info-group">
        <label for="name">Name</label>
        <input type="text" id="name">
      </div>
      <div class="info-group">
        <label for="mock-no">Mock No.</label>
        <input type="text" id="mock-no">
      </div>
      <div class="info-group">
        <label for="rank">Rank</label>
        <input type="text" id="rank">
      </div>
      <div class="info-group">
        <label for="total-marks">Total Marks</label>
        <input type="text" id="total-marks" readonly>
      </div>
      <div class="info-group">
        <label for="percentile">Percentile</label>
        <input type="text" id="percentile">
      </div>
    </div>

    <div id="subject-content">
      <!-- Subject content will be dynamically generated here -->
    </div>

    <div class="actions">
      <button id="save-data">Save Data</button>
      <button id="save-as-image">Save as Image</button>
    </div>
  </div>

  <script>
    // Data structure to hold all report data
    const reportData = {
      name: '',
      mockNo: '',
      rank: '',
      percentile: '',
      marksPerQuestion: '2',
      negativeMarking: 'none',
      subjects: {
        maths: {
          totalQuestions: '',
          attempted: '',
          correct: '',
          time: '',
          topics: {}
        },
        english: {
          totalQuestions: '',
          attempted: '',
          correct: '',
          time: '',
          topics: {}
        },
        gkgs: {
          totalQuestions: '',
          attempted: '',
          correct: '',
          time: '',
          topics: {}
        },
        reasoning: {
          totalQuestions: '',
          attempted: '',
          correct: '',
          time: '',
          topics: {}
        }
      },
      learnings: {
        maths: '',
        english: '',
        gkgs: '',
        reasoning: ''
      },
      notes: {
        maths: 'STUDENTS APPROACH',
        english: 'RULES TO REMEMBER',
        gkgs: 'WORTH IT TO NOTE',
        reasoning: 'TRICKS TO REMEMBER'
      }
    };

    // Subject details - topics for each subject
    const subjectTopics = {
      maths: {
        left: ['PERCENTAGE', 'PROFIT LOSS & DISCOUNT', 'RATIO & PROPORTION', 'MIXTURES & ALLIGATION', 'AVERAGE', 'TIME & WORK', 'TIME, SPEED, DISTANCE', 'GEOMETRY', 'SIMPLIFICATION', 'NUMBER SYSTEM'],
        right: ['ALGEBRA', 'TRIGONOMETRY', 'MENSURATION', 'LCM & HCF', 'DATA INTERPRETATION', 'C.I./S.I.']
      },
      english: {
        left: ['ERROR', 'SENTENCE IMPROVEMENT', 'FILL IN THE BLANKS', 'VOICE', 'NARRATION', 'ANTONYMS', 'SYNONYMS'],
        right: ['IDIOMS & PHRASES', 'CLOZE TEST', 'READING COMPREHENSION']
      },
      gkgs: {
        left: ['HISTORY', 'GEOGRAPHY', 'POLITY', 'SCIENCE', 'ECONOMICS', 'STATIC GK'],
        right: ['CURRENT AFFAIRS']
      },
      reasoning: {
        left: ['NUMBER SERIES', 'ALPHABET SERIES', 'ANALOGY', 'SYLLOGISM', 'MIRROR/ WATER IMAGE', 'DICTIONARY', 'CLASSIFICATIONS', 'DICE', 'FIGURE RELATED', 'ODD ONE OUT', 'CLOCK'],
        right: ['BODMASS', 'BLOOD RELATION', 'CODING DECODING', 'CALENDAR', 'MATRIX', 'MATHEMATICAL OPERATIONS', 'WORD CODING', 'RANKING & SITTING ARRANGEMENT', 'VENN DIAGRAM']
      }
    };

    // Current active subject
    let activeSubject = 'maths';

    // Load data from localStorage if available
    function loadSavedData() {
      const savedReports = JSON.parse(localStorage.getItem('ptsReports')) || {};
      return savedReports;
    }

    // Save current report data to localStorage
    function saveReportData() {
      // Gather data from form
      reportData.name = document.getElementById('name').value;
      reportData.mockNo = document.getElementById('mock-no').value;
      reportData.rank = document.getElementById('rank').value;
      reportData.percentile = document.getElementById('percentile').value;
      reportData.marksPerQuestion = document.getElementById('marks-per-question').value;
      reportData.negativeMarking = document.getElementById('negative-marking').value;
      
      // Current date as key
      const today = new Date().toISOString().split('T')[0];
      
      // Get existing reports or initialize empty object
      const savedReports = loadSavedData();
      
      // Save current report
      savedReports[today] = reportData;
      
      // Save to localStorage
      localStorage.setItem('ptsReports', JSON.stringify(savedReports));
      
      // Update breadcrumbs
      renderBreadcrumbs();
      
      alert('Report data saved successfully!');
    }

    // Render breadcrumbs from saved reports
    function renderBreadcrumbs() {
      const breadcrumbsEl = document.getElementById('breadcrumbs');
      const savedReports = loadSavedData();
      const dates = Object.keys(savedReports).sort().reverse();
      
      breadcrumbsEl.innerHTML = '';
      
      // Current date breadcrumb
      const today = new Date().toISOString().split('T')[0];
      const currentItem = document.createElement('div');
      currentItem.className = 'breadcrumb-item active';
      currentItem.textContent = today;
      breadcrumbsEl.appendChild(currentItem);
      
      // Previous saved reports breadcrumbs
      dates.forEach(date => {
        if (date !== today) {
          const item = document.createElement('div');
          item.className = 'breadcrumb-item';
          item.textContent = date;
          item.addEventListener('click', () => loadReport(date));
          breadcrumbsEl.appendChild(item);
        }
      });
    }

    // Load report by date
    function loadReport(date) {
      const savedReports = loadSavedData();
      if (savedReports[date]) {
        Object.assign(reportData, savedReports[date]);
        renderForm();
        
        // Update breadcrumbs active state
        const breadcrumbs = document.querySelectorAll('.breadcrumb-item');
        breadcrumbs.forEach(item => {
          item.classList.toggle('active', item.textContent === date);
        });
      }
    }

    // Calculate derived values and update the form
    function calculateDerivedValues() {
      const subject = reportData.subjects[activeSubject];
      
      const totalQuestions = parseInt(subject.totalQuestions) || 0;
      const attempted = parseInt(subject.attempted) || 0;
      const correct = parseInt(subject.correct) || 0;
      
      // Calculate not attempted and incorrect
      const notAttempted = Math.max(0, totalQuestions - attempted);
      const incorrect = Math.max(0, attempted - correct);
      
      // Calculate marks
      const marksPerQ = parseFloat(reportData.marksPerQuestion);
      const negativeMarkingFactor = reportData.negativeMarking === 'none' ? 0 : parseFloat(reportData.negativeMarking);
      
      const marks = (correct * marksPerQ) - (incorrect * marksPerQ * negativeMarkingFactor);
      
      // Update the form fields
      const notAttemptedEl = document.getElementById(`${activeSubject}-not-attempted`);
      const incorrectEl = document.getElementById(`${activeSubject}-incorrect`);
      const marksEl = document.getElementById(`${activeSubject}-marks`);
      
      if (notAttemptedEl) notAttemptedEl.value = notAttempted;
      if (incorrectEl) incorrectEl.value = incorrect;
      if (marksEl) marksEl.value = marks.toFixed(2);
      
      // Update total marks
      updateTotalMarks();
    }

    // Update total marks across all subjects
    function updateTotalMarks() {
      let totalMarks = 0;
      
      for (const subject in reportData.subjects) {
        const subjectData = reportData.subjects[subject];
        const totalQuestions = parseInt(subjectData.totalQuestions) || 0;
        const attempted = parseInt(subjectData.attempted) || 0;
        const correct = parseInt(subjectData.correct) || 0;
        const incorrect = Math.max(0, attempted - correct);
        
        const marksPerQ = parseFloat(reportData.marksPerQuestion);
        const negativeMarkingFactor = reportData.negativeMarking === 'none' ? 0 : parseFloat(reportData.negativeMarking);
        
        const marks = (correct * marksPerQ) - (incorrect * marksPerQ * negativeMarkingFactor);
        totalMarks += marks;
      }
      
      document.getElementById('total-marks').value = totalMarks.toFixed(2);
    }

    // Render subject content
    function renderSubjectContent() {
      const subjectContentEl = document.getElementById('subject-content');
      const subject = activeSubject;
      const topics = subjectTopics[subject];
      const noteTitle = reportData.notes[subject];
      
      subjectContentEl.innerHTML = `
        <div class="subject-header">${subject.toUpperCase()}</div>
        
        <table class="stats-table">
          <thead>
            <tr>
              <th>No. of Questions</th>
              <th>Attempted</th>
              <th>Not Attempted</th>
              <th>Correct</th>
              <th>Incorrect</th>
              <th>Time</th>
              <th>Marks</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>
                <input type="number" id="${subject}-totalQuestions" value="${reportData.subjects[subject].totalQuestions}" 
                  onchange="updateSubjectData('${subject}', 'totalQuestions', this.value)">
              </td>
              <td>
                <input type="number" id="${subject}-attempted" value="${reportData.subjects[subject].attempted}" 
                  onchange="updateSubjectData('${subject}', 'attempted', this.value)">
              </td>
              <td>
                <input type="number" id="${subject}-not-attempted" readonly>
              </td>
              <td>
                <input type="number" id="${subject}-correct" value="${reportData.subjects[subject].correct}" 
                  onchange="updateSubjectData('${subject}', 'correct', this.value)">
              </td>
              <td>
                <input type="number" id="${subject}-incorrect" readonly>
              </td>
              <td>
                <input type="text" id="${subject}-time" value="${reportData.subjects[subject].time}" 
                  onchange="updateSubjectData('${subject}', 'time', this.value)">
              </td>
              <td>
                <input type="text" id="${subject}-marks" readonly>
              </td>
            </tr>
          </tbody>
        </table>
        
        <div class="topics-container">
          <div class="topic-section">
            <div class="topic-header">
              <h3>Q</h3>
              <h3>What went wrong</h3>
            </div>
            <div class="topic-list">
              ${topics.left.map(topic => `
                <div class="topic-row">
                  <div>${topic}</div>
                  <input type="text" id="${subject}-${topic.replace(/\s+/g, '-').toLowerCase()}">
                </div>
              `).join('')}
            </div>
          </div>
          
          <div class="topic-section">
            <div class="topic-header">
              <h3>Q</h3>
              <h3>What went wrong</h3>
            </div>
            <div class="topic-list">
              ${topics.right.map(topic => `
                <div class="topic-row">
                  <div>${topic}</div>
                  <input type="text" id="${subject}-${topic.replace(/\s+/g, '-').toLowerCase()}">
                </div>
              `).join('')}
            </div>
            
            <div class="learning-section">
              <h4>LEARNINGS</h4>
              <textarea 
                id="${subject}-learnings" 
                class="text-area"
                onchange="updateLearning('${subject}', this.value)"
              >${reportData.learnings[subject] || ''}</textarea>
            </div>
          </div>
        </div>
        
        <div class="notes-section">
          <h3>${noteTitle}</h3>
          <textarea 
            id="${subject}-notes" 
            class="text-area"
          ></textarea>
        </div>
      `;
      
      calculateDerivedValues();
    }

    // Update subject data in memory
    function updateSubjectData(subject, field, value) {
      reportData.subjects[subject][field] = value;
      calculateDerivedValues();
    }

    // Update learning text in memory
    function updateLearning(subject, value) {
      reportData.learnings[subject] = value;
    }

    // Render the entire form
    function renderForm() {
      // Set form values from reportData
      document.getElementById('name').value = reportData.name || '';
      document.getElementById('mock-no').value = reportData.mockNo || '';
      document.getElementById('rank').value = reportData.rank || '';
      document.getElementById('percentile').value = reportData.percentile || '';
      document.getElementById('marks-per-question').value = reportData.marksPerQuestion || '2';
      document.getElementById('negative-marking').value = reportData.negativeMarking || 'none';
      
      // Render current subject content
      renderSubjectContent();
    }

    // Switch active subject
    function switchSubject(subject) {
      activeSubject = subject;
      
      // Update active class on subject tabs
      const subjectEls = document.querySelectorAll('.subject');
      subjectEls.forEach(el => {
        el.classList.toggle('active', el.dataset.subject === subject);
      });
      
      // Render the content for the selected subject
      renderSubjectContent();
    }

    // Save report card as image
    function saveAsImage() {
      html2canvas(document.getElementById('report-card')).then(canvas => {
        const link = document.createElement('a');
        link.download = `PTS_Report_${new Date().toISOString().split('T')[0]}.png`;
        link.href = canvas.toDataURL('image/png');
        link.click();
      });
    }

    // Initialize the app
    funct

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PTS Report Card</title>
    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Material UI CSS -->
    <link href="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #1976d2;
            --secondary-color: #f5f5f5;
        }

        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
        }

        .controls {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .subject-container {
            display: flex;
            overflow-x: auto;
            gap: 20px;
            padding-bottom: 10px;
        }

        .subject-card {
            min-width: 300px;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        input {
            width: 50px;
            padding: 4px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        button {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
        }

        .breadcrumbs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .save-section {
            margin-top: 20px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="controls">
        <div>
            <button onclick="saveData()">ðŸ’¾ Save Current</button>
            <button onclick="capture()">ðŸ“¸ Save as Image</button>
        </div>
        <div>
            Marks/Q: 
            <select id="marksPerQ" onchange="updateSettings()">
                <option value="2/3">2/3</option>
                <option value="1">1</option>
            </select>
        </div>
        <div>
            Negative: 
            <select id="negativeMarking" onchange="updateSettings()">
                <option value="0">None</option>
                <option value="1/2">1/2</option>
                <option value="1/3">1/3</option>
                <option value="1/4">1/4</option>
            </select>
        </div>
    </div>

    <div id="breadcrumbs" class="breadcrumbs"></div>

    <div id="reportCard" class="subject-container">
        <!-- Subjects will be dynamically generated -->
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script>
        const subjects = ['MATHS', 'ENGLISH', 'GK/GS', 'REASONING'];
        let state = {
            settings: { marksPerQ: '2/3', negativeMarking: '0' },
            data: {}
        };

        // Initialize app
        function init() {
            loadSavedDates();
            renderSubjects();
        }

        function renderSubjects() {
            const container = document.getElementById('reportCard');
            container.innerHTML = subjects.map(subject => `
                <div class="subject-card">
                    <h3>${subject}</h3>
                    <table>
                        <tr>
                            <th>Total Q</th>
                            <th>Attempted</th>
                            <th>Not Attempted</th>
                            <th>Correct</th>
                            <th>Incorrect</th>
                        </tr>
                        <tr>
                            <td><input type="number" id="${subject}-total" onchange="calculateFields('${subject}')"></td>
                            <td><input type="number" id="${subject}-attempted" onchange="calculateFields('${subject}')"></td>
                            <td><input type="number" id="${subject}-unattempted" readonly></td>
                            <td><input type="number" id="${subject}-correct" onchange="calculateFields('${subject}')"></td>
                            <td><input type="number" id="${subject}-incorrect" readonly></td>
                        </tr>
                    </table>
                </div>
            `).join('');
        }

        function calculateFields(subject) {
            const total = parseInt(document.getElementById(`${subject}-total`).value) || 0;
            const attempted = parseInt(document.getElementById(`${subject}-attempted`).value) || 0;
            const correct = parseInt(document.getElementById(`${subject}-correct`).value) || 0;
            
            document.getElementById(`${subject}-unattempted`).value = total - attempted;
            document.getElementById(`${subject}-incorrect`).value = attempted - correct;
        }

        function saveData() {
            const date = new Date().toISOString().split('T')[0];
            const data = {};
            
            subjects.forEach(subject => {
                data[subject] = {
                    total: document.getElementById(`${subject}-total`).value,
                    attempted: document.getElementById(`${subject}-attempted`).value,
                    correct: document.getElementById(`${subject}-correct`).value
                };
            });

            localStorage.setItem(date, JSON.stringify(data));
            loadSavedDates();
        }

        function loadSavedDates() {
            const breadcrumbs = document.getElementById('breadcrumbs');
            breadcrumbs.innerHTML = '';
            
            for(let i = 0; i < localStorage.length; i++) {
                const date = localStorage.key(i);
                const btn = document.createElement('button');
                btn.textContent = date;
                btn.onclick = () => loadData(date);
                breadcrumbs.appendChild(btn);
            }
        }

        function loadData(date) {
            const data = JSON.parse(localStorage.getItem(date));
            subjects.forEach(subject => {
                if(data[subject]) {
                    document.getElementById(`${subject}-total`).value = data[subject].total;
                    document.getElementById(`${subject}-attempted`).value = data[subject].attempted;
                    document.getElementById(`${subject}-correct`).value = data[subject].correct;
                    calculateFields(subject);
                }
            });
        }

        function updateSettings() {
            state.settings.marksPerQ = document.getElementById('marksPerQ').value;
            state.settings.negativeMarking = document.getElementById('negativeMarking').value;
        }

        function capture() {
            html2canvas(document.querySelector("#reportCard")).then(canvas => {
                const link = document.createElement('a');
                link.download = 'report-card.png';
                link.href = canvas.toDataURL();
                link.click();
            });
        }

        // Start the app
        init();
    </script>
</body>
  </html>
